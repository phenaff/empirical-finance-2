<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="23 The Model of Hull &amp; White | Topics in Empirical Finance" />
<meta property="og:type" content="book" />
<meta property="og:image" content="/img/frontCover.pdf" />
<meta property="og:description" content="An open access textbook on empirical finance" />
<meta name="github-repo" content="phenaff/empirical-finance-2" />

<meta name="author" content="Patrick Hénaff" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="An open access textbook on empirical finance">

<title>23 The Model of Hull &amp; White | Topics in Empirical Finance</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      extensions: ["color.js"]
    }
  });
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="custom.css" type="text/css" />

</head>

<body>


<div style="display: none;">
$$
  \newcommand{\given}{\mid}
  \renewcommand{\neg}{\mathbin{\sim}}
  \renewcommand{\wedge}{\mathbin{\&}}
  \newcommand{\p}{Pr}
  \newcommand{\degr}{^{\circ}}
  \newcommand{\E}{E}
  \newcommand{\EU}{EU}
  \newcommand{\u}{U}
  \newcommand{\pr}{Pr}
  \newcommand{\po}{Pr^*}
  \definecolor{bookred}{RGB}{228,6,19}
  \definecolor{bookblue}{RGB}{0,92,169}
  \definecolor{bookpurple}{RGB}{114,49,94} 
$$
</div>

<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface-to-the-second-edition">Preface to the second edition</a></li>
<li><a href="preface-to-the-first-edition.html#preface-to-the-first-edition">Preface to the first edition</a></li>
<li class="part"><span><b>Computational Framework</b></span></li>
<li><a href="introduction.html#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li class="has-sub"><a href="ch:data-sources.html#ch:data-sources"><span class="toc-section-number">2</span> Data Sources</a>
<ul>
<li><a href="ch:data-sources.html#commodities-data"><span class="toc-section-number">2.1</span> Commodities Data</a></li>
<li><a href="ch:data-sources.html#libor-rates"><span class="toc-section-number">2.2</span> Libor Rates</a></li>
<li><a href="ch:data-sources.html#sovereign-yield-curves"><span class="toc-section-number">2.3</span> Sovereign Yield Curves</a></li>
<li><a href="ch:data-sources.html#equities-data"><span class="toc-section-number">2.4</span> Equities Data</a></li>
</ul></li>
<li class="has-sub"><a href="basic-components.html#basic-components"><span class="toc-section-number">3</span> Basic Components</a>
<ul>
<li class="has-sub"><a href="basic-components.html#the-finstrument-class"><span class="toc-section-number">3.1</span> The <idx>fInstrument</idx> Class</a>
<ul>
<li><a href="basic-components.html#design-and-implementation"><span class="toc-section-number">3.1.1</span> Design and Implementation</a></li>
</ul></li>
<li class="has-sub"><a href="basic-components.html#the-dataprovider-class"><span class="toc-section-number">3.2</span> The <idx>DataProvider</idx> Class</a>
<ul>
<li><a href="basic-components.html#the-model-for-market-data"><span class="toc-section-number">3.2.1</span> The Model for Market Data</a></li>
<li><a href="basic-components.html#the-search-algorithm"><span class="toc-section-number">3.2.2</span> The Search Algorithm</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="sim-framework.html#sim-framework"><span class="toc-section-number">4</span> The Simulation Framework</a>
<ul>
<li><a href="sim-framework.html#scenario-simulator"><span class="toc-section-number">4.1</span> Scenario Simulator</a></li>
<li class="has-sub"><a href="sim-framework.html#a-delta-hedging-experiment"><span class="toc-section-number">4.2</span> A Delta Hedging Experiment</a>
<ul>
<li><a href="sim-framework.html#design-considerations"><span class="toc-section-number">4.2.1</span> Design Considerations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Discreet Models</b></span></li>
<li class="has-sub"><a href="arb-free-pricing.html#arb-free-pricing"><span class="toc-section-number">5</span> Arbitrage-Free Pricing and Risk Neutral Valuation</a>
<ul>
<li class="has-sub"><a href="arb-free-pricing.html#arbitrage-free-pricing"><span class="toc-section-number">5.1</span> Arbitrage-free Pricing</a>
<ul>
<li><a href="arb-free-pricing.html#arrow-debreu-securities"><span class="toc-section-number">5.1.1</span> Arrow-Debreu Securities</a></li>
<li><a href="arb-free-pricing.html#the-price-of-traded-securities"><span class="toc-section-number">5.1.2</span> The Price of Traded Securities</a></li>
<li><a href="arb-free-pricing.html#complete-market"><span class="toc-section-number">5.1.3</span> Complete Market</a></li>
<li><a href="arb-free-pricing.html#equivalent-probability-measures"><span class="toc-section-number">5.1.4</span> Equivalent Probability Measures</a></li>
<li><a href="arb-free-pricing.html#the-impact-of-interest-rate"><span class="toc-section-number">5.1.5</span> The Impact of Interest Rate</a></li>
<li><a href="arb-free-pricing.html#trading-strategy-and-dynamic-completeness"><span class="toc-section-number">5.1.6</span> Trading Strategy and Dynamic Completeness</a></li>
<li><a href="arb-free-pricing.html#discounted-asset-prices-as-martingales"><span class="toc-section-number">5.1.7</span> Discounted Asset Prices as Martingales</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="binomial.html#binomial"><span class="toc-section-number">6</span> Risk-Neutral Pricing in a Binomial Framework</a>
<ul>
<li class="has-sub"><a href="binomial.html#introduction-1"><span class="toc-section-number">6.1</span> Introduction</a>
<ul>
<li><a href="binomial.html#subsec:binomial"><span class="toc-section-number">6.1.1</span> The Binomial Model for Stocks</a></li>
</ul></li>
<li><a href="binomial.html#pricing-with-arrow-debreu-securities"><span class="toc-section-number">6.2</span> Pricing With Arrow-Debreu Securities</a></li>
<li><a href="binomial.html#multi-period-binomial-model"><span class="toc-section-number">6.3</span> Multi-Period Binomial Model</a></li>
<li><a href="binomial.html#american-exercise"><span class="toc-section-number">6.4</span> American Exercise</a></li>
<li class="has-sub"><a href="binomial.html#calibration-of-the-binomial-model"><span class="toc-section-number">6.5</span> Calibration of the Binomial Model</a>
<ul>
<li><a href="binomial.html#tree-geometry"><span class="toc-section-number">6.5.1</span> Tree Geometry</a></li>
</ul></li>
</ul></li>
<li><a href="stability-of-the-binomial-model.html#stability-of-the-binomial-model"><span class="toc-section-number">7</span> Stability of the Binomial Model</a></li>
<li class="has-sub"><a href="sec:trinomial.html#sec:trinomial"><span class="toc-section-number">8</span> Trinomial Models</a>
<ul>
<li><a href="sec:trinomial.html#the-trinomial-tree"><span class="toc-section-number">8.1</span> The Trinomial Tree</a></li>
</ul></li>
<li class="part"><span><b>Derivatives in the Black-Scholes Framework</b></span></li>
<li class="has-sub"><a href="pricing-with-black-scholes.html#pricing-with-black-scholes"><span class="toc-section-number">9</span> Pricing with Black-Scholes</a>
<ul>
<li><a href="pricing-with-black-scholes.html#relationships-among-greeks"><span class="toc-section-number">9.1</span> Relationships Among Greeks</a></li>
</ul></li>
<li class="has-sub"><a href="applicability-of-the-black-scholes-model.html#applicability-of-the-black-scholes-model"><span class="toc-section-number">10</span> Applicability of the Black-Scholes Model</a>
<ul>
<li><a href="applicability-of-the-black-scholes-model.html#self-financing-replicating-portfolio"><span class="toc-section-number">10.1</span> Self-Financing Replicating Portfolio</a></li>
<li><a href="applicability-of-the-black-scholes-model.html#hedging-error-due-to-discrete-hedging"><span class="toc-section-number">10.2</span> Hedging Error due to Discrete Hedging</a></li>
<li><a href="applicability-of-the-black-scholes-model.html#error-due-to-unknown-volatility"><span class="toc-section-number">10.3</span> Error due to Unknown Volatility</a></li>
<li class="has-sub"><a href="applicability-of-the-black-scholes-model.html#second-order-hedging"><span class="toc-section-number">10.4</span> Second-Order Hedging</a>
<ul>
<li><a href="applicability-of-the-black-scholes-model.html#gamma-smoothing"><span class="toc-section-number">10.4.1</span> Gamma Smoothing</a></li>
<li><a href="applicability-of-the-black-scholes-model.html#dynamic-delta-gamma-hedge"><span class="toc-section-number">10.4.2</span> Dynamic Delta-Gamma hedge</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="price-and-greeks-in-the-black-scholes-model.html#price-and-greeks-in-the-black-scholes-model"><span class="toc-section-number">11</span> Price and Greeks in the Black-Scholes Model</a>
<ul>
<li><a href="price-and-greeks-in-the-black-scholes-model.html#solving-the-pricing-equation"><span class="toc-section-number">11.1</span> Solving the Pricing Equation</a></li>
<li class="has-sub"><a href="price-and-greeks-in-the-black-scholes-model.html#an-option-dashboard"><span class="toc-section-number">11.2</span> An Option Dashboard</a>
<ul>
<li><a href="price-and-greeks-in-the-black-scholes-model.html#vanilla-option"><span class="toc-section-number">11.2.1</span> Vanilla Option</a></li>
<li><a href="price-and-greeks-in-the-black-scholes-model.html#binary-option"><span class="toc-section-number">11.2.2</span> Binary Option</a></li>
<li><a href="price-and-greeks-in-the-black-scholes-model.html#barrier-option"><span class="toc-section-number">11.2.3</span> Barrier Option</a></li>
<li><a href="price-and-greeks-in-the-black-scholes-model.html#asian-option"><span class="toc-section-number">11.2.4</span> Asian Option</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="dynamic-hedging-with-the-black-scholes-model.html#dynamic-hedging-with-the-black-scholes-model"><span class="toc-section-number">12</span> Dynamic Hedging with the Black-Scholes Model</a>
<ul>
<li><a href="dynamic-hedging-with-the-black-scholes-model.html#self-financing-replicating-portfolio-1"><span class="toc-section-number">12.1</span> Self-Financing Replicating Portfolio</a></li>
<li><a href="dynamic-hedging-with-the-black-scholes-model.html#hedging-error-due-to-discrete-hedging-1"><span class="toc-section-number">12.2</span> Hedging Error due to Discrete Hedging</a></li>
<li><a href="dynamic-hedging-with-the-black-scholes-model.html#error-due-to-unknown-volatility-1"><span class="toc-section-number">12.3</span> Error due to Unknown Volatility</a></li>
<li class="has-sub"><a href="dynamic-hedging-with-the-black-scholes-model.html#second-order-hedging-1"><span class="toc-section-number">12.4</span> Second-Order Hedging</a>
<ul>
<li><a href="dynamic-hedging-with-the-black-scholes-model.html#gamma-smoothing-1"><span class="toc-section-number">12.4.1</span> Gamma Smoothing</a></li>
<li><a href="dynamic-hedging-with-the-black-scholes-model.html#dynamic-delta-gamma-hedge-1"><span class="toc-section-number">12.4.2</span> Dynamic Delta-Gamma hedge</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="dynamic-hedging-in-the-black-scholes-framework.html#dynamic-hedging-in-the-black-scholes-framework"><span class="toc-section-number">13</span> Dynamic Hedging in the Black-Scholes Framework</a>
<ul>
<li class="has-sub"><a href="dynamic-hedging-in-the-black-scholes-framework.html#self-financing-replicating-portfolio-2"><span class="toc-section-number">13.1</span> Self-Financing Replicating Portfolio</a>
<ul>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#continuous-rebalancing"><span class="toc-section-number">13.1.1</span> Continuous rebalancing</a></li>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#discreet-rebalancing"><span class="toc-section-number">13.1.2</span> Discreet rebalancing</a></li>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#illustration"><span class="toc-section-number">13.1.3</span> Illustration</a></li>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#a-more-realistic-example"><span class="toc-section-number">13.1.4</span> A More Realistic Example</a></li>
</ul></li>
<li class="has-sub"><a href="dynamic-hedging-in-the-black-scholes-framework.html#hedging-error-due-to-discrete-hedging-2"><span class="toc-section-number">13.2</span> Hedging Error due to Discrete Hedging</a>
<ul>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#empirical-test"><span class="toc-section-number">13.2.1</span> Empirical Test</a></li>
</ul></li>
<li class="has-sub"><a href="dynamic-hedging-in-the-black-scholes-framework.html#hedging-error-due-to-transaction-cost"><span class="toc-section-number">13.3</span> Hedging Error due to Transaction Cost</a>
<ul>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#empirical-test-1"><span class="toc-section-number">13.3.1</span> Empirical Test</a></li>
</ul></li>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#hedging-error-due-to-unknown-volatility"><span class="toc-section-number">13.4</span> Hedging Error due to Unknown Volatility</a></li>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#conclusion"><span class="toc-section-number">13.5</span> Conclusion</a></li>
<li><a href="dynamic-hedging-in-the-black-scholes-framework.html#second-order-hedging-2"><span class="toc-section-number">13.6</span> Second-Order Hedging</a></li>
</ul></li>
<li class="has-sub"><a href="the-implied-volatility.html#the-implied-volatility"><span class="toc-section-number">14</span> The implied volatility</a>
<ul>
<li><a href="the-implied-volatility.html#market-data"><span class="toc-section-number">14.1</span> Market Data</a></li>
<li class="has-sub"><a href="the-implied-volatility.html#calculation-of-implied-volatility"><span class="toc-section-number">14.2</span> Calculation of implied volatility</a>
<ul>
<li><a href="the-implied-volatility.html#newtons-method"><span class="toc-section-number">14.2.1</span> Newton’s method</a></li>
<li><a href="the-implied-volatility.html#implied-volatility-by-newtons-method"><span class="toc-section-number">14.2.2</span> Implied Volatility by Newton’s Method</a></li>
<li><a href="the-implied-volatility.html#secant-method"><span class="toc-section-number">14.2.3</span> Secant Method</a></li>
<li><a href="the-implied-volatility.html#jaeckels-method"><span class="toc-section-number">14.2.4</span> Jaeckel’s method</a></li>
<li><a href="the-implied-volatility.html#normalized-call-price-as-a-function-of-sigma"><span class="toc-section-number">14.2.5</span> Normalized Call price as a function of <span class="math inline">\(\sigma\)</span></a></li>
<li><a href="the-implied-volatility.html#transformed-objective-function"><span class="toc-section-number">14.2.6</span> Transformed objective function</a></li>
<li><a href="the-implied-volatility.html#impact-of-dividends"><span class="toc-section-number">14.2.7</span> Impact of Dividends</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="vanna-volga-pricing-and-hedging.html#vanna-volga-pricing-and-hedging"><span class="toc-section-number">15</span> Vanna-Volga Pricing and Hedging</a>
<ul>
<li class="has-sub"><a href="vanna-volga-pricing-and-hedging.html#principle"><span class="toc-section-number">15.1</span> Principle</a>
<ul>
<li><a href="vanna-volga-pricing-and-hedging.html#vanna-volga-dynamic-hedging"><span class="toc-section-number">15.1.1</span> Vanna-Volga Dynamic Hedging</a></li>
</ul></li>
<li class="has-sub"><a href="vanna-volga-pricing-and-hedging.html#implementation"><span class="toc-section-number">15.2</span> Implementation</a>
<ul>
<li><a href="vanna-volga-pricing-and-hedging.html#vanna-volga-dynamic-hedging-1"><span class="toc-section-number">15.2.1</span> Vanna-Volga Dynamic Hedging</a></li>
</ul></li>
<li class="has-sub"><a href="vanna-volga-pricing-and-hedging.html#illustrations"><span class="toc-section-number">15.3</span> Illustrations</a>
<ul>
<li><a href="vanna-volga-pricing-and-hedging.html#volatility-interpolation"><span class="toc-section-number">15.3.1</span> Volatility Interpolation</a></li>
<li><a href="vanna-volga-pricing-and-hedging.html#pricing-a-binary-option"><span class="toc-section-number">15.3.2</span> Pricing a Binary Option</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Fixed Income</b></span></li>
<li class="has-sub"><a href="fi:elementary.html#fi:elementary"><span class="toc-section-number">16</span> Elementary Fixed Income Calculations</a>
<ul>
<li><a href="fi:elementary.html#bond-pricing"><span class="toc-section-number">16.1</span> Bond Pricing</a></li>
<li><a href="fi:elementary.html#the-price-yield-curves"><span class="toc-section-number">16.2</span> The Price-Yield Curves</a></li>
<li class="has-sub"><a href="fi:elementary.html#basic-measures-of-interest-rate-risk"><span class="toc-section-number">16.3</span> Basic Measures of Interest Rate Risk</a>
<ul>
<li><a href="fi:elementary.html#variation"><span class="toc-section-number">16.3.1</span> Variation</a></li>
<li><a href="fi:elementary.html#approximate-portfolio-yield"><span class="toc-section-number">16.3.2</span> Approximate Portfolio Yield</a></li>
<li><a href="fi:elementary.html#sensitivity"><span class="toc-section-number">16.3.3</span> Sensitivity</a></li>
<li><a href="fi:elementary.html#modified-duration-of-a-portfolio"><span class="toc-section-number">16.3.4</span> Modified Duration of a Portfolio</a></li>
<li><a href="fi:elementary.html#duration"><span class="toc-section-number">16.3.5</span> Duration</a></li>
<li><a href="fi:elementary.html#sec:duration-of-a-portfolio"><span class="toc-section-number">16.3.6</span> Duration of a Portfolio</a></li>
</ul></li>
<li><a href="fi:elementary.html#bond-clean-and-dirty-price"><span class="toc-section-number">16.4</span> Bond Clean and Dirty Price</a></li>
</ul></li>
<li class="has-sub"><a href="the-term-structure-of-interest-rates.html#the-term-structure-of-interest-rates"><span class="toc-section-number">17</span> The Term Structure of Interest Rates</a>
<ul>
<li><a href="the-term-structure-of-interest-rates.html#term-structure-shapes"><span class="toc-section-number">17.1</span> Term Structure Shapes</a></li>
<li><a href="the-term-structure-of-interest-rates.html#building-a-zero-coupon-bond-curve"><span class="toc-section-number">17.2</span> Building a Zero-Coupon Bond Curve</a></li>
<li><a href="the-term-structure-of-interest-rates.html#functional-forms-for-the-zero-coupon-curve"><span class="toc-section-number">17.3</span> Functional forms for the zero-coupon curve</a></li>
</ul></li>
<li class="has-sub"><a href="simple-interest-rate-derivatives.html#simple-interest-rate-derivatives"><span class="toc-section-number">18</span> Simple Interest Rate Derivatives</a>
<ul>
<li><a href="simple-interest-rate-derivatives.html#spot-and-forward-interest-rates"><span class="toc-section-number">18.1</span> Spot and Forward Interest Rates</a></li>
<li><a href="simple-interest-rate-derivatives.html#forward-rate-agreement-fra"><span class="toc-section-number">18.2</span> Forward Rate Agreement (FRA)</a></li>
<li class="has-sub"><a href="simple-interest-rate-derivatives.html#t-bill-futures"><span class="toc-section-number">18.3</span> T-Bill Futures</a>
<ul>
<li><a href="simple-interest-rate-derivatives.html#arbitrage"><span class="toc-section-number">18.3.1</span> Arbitrage</a></li>
<li><a href="simple-interest-rate-derivatives.html#quotes"><span class="toc-section-number">18.3.2</span> Quotes</a></li>
</ul></li>
<li><a href="simple-interest-rate-derivatives.html#euro-currency-futures"><span class="toc-section-number">18.4</span> Euro-Currency Futures</a></li>
<li><a href="simple-interest-rate-derivatives.html#eurodollar-rate-versus-forward-rate"><span class="toc-section-number">18.5</span> Eurodollar Rate Versus Forward Rate</a></li>
<li class="has-sub"><a href="simple-interest-rate-derivatives.html#convexity-adjustment"><span class="toc-section-number">18.6</span> Convexity Adjustment</a>
<ul>
<li><a href="simple-interest-rate-derivatives.html#special-case-of-natural-time-lag"><span class="toc-section-number">18.6.1</span> Special Case of Natural Time Lag</a></li>
<li><a href="simple-interest-rate-derivatives.html#convexity-adjustment-examples"><span class="toc-section-number">18.6.2</span> Convexity Adjustment Examples</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="bond-futures.html#bond-futures"><span class="toc-section-number">19</span> Bond Futures</a>
<ul>
<li><a href="bond-futures.html#forward-price"><span class="toc-section-number">19.1</span> Forward Price</a></li>
<li><a href="bond-futures.html#delivery-against-the-futures-contract"><span class="toc-section-number">19.2</span> Delivery against the Futures contract</a></li>
<li><a href="bond-futures.html#the-conversion-factor"><span class="toc-section-number">19.3</span> The Conversion Factor</a></li>
<li><a href="bond-futures.html#determination-of-the-cheapest-to-deliver"><span class="toc-section-number">19.4</span> Determination of the Cheapest to Deliver</a></li>
<li><a href="bond-futures.html#implied-repo-rate"><span class="toc-section-number">19.5</span> Implied Repo Rate</a></li>
<li><a href="bond-futures.html#the-delivery-option"><span class="toc-section-number">19.6</span> The Delivery Option</a></li>
<li><a href="bond-futures.html#ir-sensitivity-of-bund-futures"><span class="toc-section-number">19.7</span> IR sensitivity of Bund Futures</a></li>
<li><a href="bond-futures.html#cash-carry-arbitrage"><span class="toc-section-number">19.8</span> Cash-Carry Arbitrage</a></li>
<li><a href="bond-futures.html#hedging-a-bond-with-a-euro-bund-contract"><span class="toc-section-number">19.9</span> Hedging a Bond with a Euro-Bund Contract</a></li>
</ul></li>
<li class="has-sub"><a href="libor-swaps.html#libor-swaps"><span class="toc-section-number">20</span> Libor Swaps</a>
<ul>
<li><a href="libor-swaps.html#ir-swap-pricing"><span class="toc-section-number">20.1</span> IR Swap Pricing</a></li>
</ul></li>
<li class="has-sub"><a href="fixed-income-risk-management.html#fixed-income-risk-management"><span class="toc-section-number">21</span> Fixed Income Risk Management</a>
<ul>
<li><a href="fixed-income-risk-management.html#immunization"><span class="toc-section-number">21.1</span> Immunization</a></li>
<li><a href="fixed-income-risk-management.html#dedication"><span class="toc-section-number">21.2</span> Dedication</a></li>
</ul></li>
<li class="has-sub"><a href="the-vasicek-model.html#the-vasicek-model"><span class="toc-section-number">22</span> The Vasicek Model</a>
<ul>
<li><a href="the-vasicek-model.html#derivatives-with-non-traded-underlying-asset"><span class="toc-section-number">22.1</span> Derivatives with Non Traded Underlying Asset</a></li>
<li><a href="the-vasicek-model.html#the-market-price-of-interest-rate-risk"><span class="toc-section-number">22.2</span> The Market Price of Interest Rate Risk</a></li>
</ul></li>
<li class="has-sub"><a href="the-model-of-hull-white.html#the-model-of-hull-white"><span class="toc-section-number">23</span> The Model of Hull &amp; White</a>
<ul>
<li><a href="the-model-of-hull-white.html#moments-of-x_t-under-a-ou-process"><span class="toc-section-number">23.1</span> Moments of <span class="math inline">\(x_t\)</span> under a OU Process</a></li>
<li class="has-sub"><a href="the-model-of-hull-white.html#the-hull-white-trinomial-model"><span class="toc-section-number">23.2</span> The Hull &amp; White Trinomial Model</a>
<ul>
<li><a href="the-model-of-hull-white.html#step-1"><span class="toc-section-number">23.2.1</span> Step 1</a></li>
<li><a href="the-model-of-hull-white.html#step-2"><span class="toc-section-number">23.2.2</span> Step 2</a></li>
</ul></li>
<li><a href="the-model-of-hull-white.html#generalization"><span class="toc-section-number">23.3</span> Generalization</a></li>
</ul></li>
<li class="has-sub"><a href="deterministic-time-varying-volatility.html#deterministic-time-varying-volatility"><span class="toc-section-number">24</span> Deterministic Time-Varying Volatility</a>
<ul>
<li><a href="deterministic-time-varying-volatility.html#gabillons-model"><span class="toc-section-number">24.1</span> Gabillon’s Model</a></li>
<li><a href="deterministic-time-varying-volatility.html#deterministic-volatility-in-a-seasonal-market"><span class="toc-section-number">24.2</span> Deterministic Volatility in a Seasonal Market</a></li>
</ul></li>
<li class="has-sub"><a href="pricing-under-an-objective-density.html#pricing-under-an-objective-density"><span class="toc-section-number">25</span> Pricing under an Objective Density</a>
<ul>
<li><a href="pricing-under-an-objective-density.html#conditional-entropy"><span class="toc-section-number">25.1</span> Conditional Entropy</a></li>
<li><a href="pricing-under-an-objective-density.html#relative-entropy-of-uniform-densities"><span class="toc-section-number">25.2</span> Relative Entropy of Uniform Densities</a></li>
<li class="has-sub"><a href="pricing-under-an-objective-density.html#computation-of-a-risk-neutral-density"><span class="toc-section-number">25.3</span> Computation of a Risk-neutral Density</a>
<ul>
<li><a href="pricing-under-an-objective-density.html#calculation-of-risk-neutral-density-p"><span class="toc-section-number">25.3.1</span> Calculation of Risk-Neutral Density <span class="math inline">\(P\)</span></a></li>
<li><a href="pricing-under-an-objective-density.html#matching-market-data"><span class="toc-section-number">25.3.2</span> Matching Market Data</a></li>
<li><a href="pricing-under-an-objective-density.html#solution"><span class="toc-section-number">25.3.3</span> Solution</a></li>
<li><a href="pricing-under-an-objective-density.html#solution-1"><span class="toc-section-number">25.3.4</span> Solution</a></li>
<li><a href="pricing-under-an-objective-density.html#illustration-1"><span class="toc-section-number">25.3.5</span> Illustration</a></li>
<li><a href="pricing-under-an-objective-density.html#a-lottery-ticket"><span class="toc-section-number">25.3.6</span> A Lottery Ticket…</a></li>
</ul></li>
<li class="has-sub"><a href="pricing-under-an-objective-density.html#monte-carlo-pricing-with-historical-paths"><span class="toc-section-number">25.4</span> Monte-Carlo Pricing with Historical Paths</a>
<ul>
<li><a href="pricing-under-an-objective-density.html#sec:model"><span class="toc-section-number">25.4.1</span> The Model</a></li>
<li><a href="pricing-under-an-objective-density.html#incorporation-of-bid-ask-spread"><span class="toc-section-number">25.4.2</span> Incorporation of bid-ask spread</a></li>
<li><a href="pricing-under-an-objective-density.html#extension-to-arbitrary-cash-flows"><span class="toc-section-number">25.4.3</span> Extension to arbitrary cash flows</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="the-model-of-hull-white" class="section level1" number="23">
<h1><span class="header-section-number">23</span> The Model of Hull &amp; White</h1>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="the-model-of-hull-white.html#cb344-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(fBasics)</span></code></pre></div>
<p><span class="newthought">Hull and White</span> have developed a trinomial model for the short rate, that
can be exactly calibrated to the zero-coupon curve. The short rate
process is an Ornstein-Uhlenbeck (OU) mean reverting process, and we
start this section by a short review of the properties of this process.</p>
<div id="moments-of-x_t-under-a-ou-process" class="section level2" number="23.1">
<h2><span class="header-section-number">23.1</span> Moments of <span class="math inline">\(x_t\)</span> under a OU Process</h2>
<p>To construct a Hull &amp; White model of the short rate, we need to compute
the moments of a OU process:</p>
<p><span class="math display">\[dx_t = \theta(\mu-x_t) dt + \sigma dW_T\]</span></p>
<p>To compute <span class="math inline">\(E(x_t)\)</span>, consider the function</p>
<p><span class="math display">\[f(x, t) = x e^{\theta t}\]</span></p>
<p>Apply Ito’s Lemma:</p>
<p><span class="math display">\[\begin{aligned}
df &amp;=&amp; (\theta x_t e^{\theta t} + \theta(\mu-x_t) e^{\theta t}) dt + \sigma e^{\theta t} dW \\
  &amp;=&amp; \theta \mu e^{\theta t} dt + \sigma e^{\theta t} dW
\end{aligned}\]</span></p>
<p>Integrate:</p>
<p><span class="math display">\[\begin{aligned}
x_t e^{\theta t} &amp;=&amp; x_0 + \theta \mu \int_0^t e^{\theta u} du + \sigma \int_0^t e^{\theta u} dW_u \\
&amp;=&amp; x_0 + \mu (e^{\theta t} - 1) +\sigma \int_0^t e^{\theta u} dW_u \\
x_t &amp;=&amp; x_0 e^{-\theta t} + \mu (1-e^{-\theta t}) +\sigma \int_0^t e^{-\theta (t-u)} dW_u
\end{aligned}\]</span></p>
<p>Thus,</p>
<p><span class="math display" id="eq:mean-ou">\[E(x_t) = x_0 e^{-\theta t} + \mu (1-e^{-\theta t})
\tag{23.1}\]</span></p>
<p>The variance of <span class="math inline">\(x_t\)</span> is now easily computed:</p>
<p><span class="math display">\[\begin{aligned}
V(x_t) &amp;=&amp; E\left[ (x_t - E(x_t))^2 \right] \\
&amp;=&amp; E \left[ \sigma^2 \left( \int_0^t e^{-\theta(t-u)} dW_u \right)^2 \right] \\
&amp;=&amp; \sigma^2 e^{-2\theta t} E \left[  \left( \int_0^t e^{\theta u} dW_u \right)^2 \right] \\
&amp;=&amp; \sigma^2 e^{-2\theta t} \int_0^t e^{2\theta u} du
\end{aligned}\]</span></p>
<p>Finally,</p>
<p><span class="math display" id="eq:var-ou">\[V(x_t) = \frac{\sigma^2}{2 \theta} (1-e^{-2 \theta t})
\tag{23.2}\]</span></p>
</div>
<div id="the-hull-white-trinomial-model" class="section level2" number="23.2">
<h2><span class="header-section-number">23.2</span> The Hull &amp; White Trinomial Model</h2>
<p>The Hull &amp; White model defines an OU process for the short rate:</p>
<p><span class="math display">\[d r_t = (\theta(t) - a r_t) dt + \sigma dz_t\]</span></p>
<p>This is an generalization of Vasicek’s model, which defined the
following process for the short rate:</p>
<p><span class="math display">\[d r_t = a(b - r_t) dt + \sigma dz_t\]</span></p>
<p>Using results from Vasicek’s, one could compute an analytical expression
for <span class="math inline">\(\theta(t)\)</span> such that the process is consistent with observed
zero-coupon yields. Rather than doing that, however, we will construct a
discretized representation of the process with a trinomial tree, and
calibrate the parameters of that tree so that the discretized model
reprices exactly the zero-coupons.</p>
<p>The tree is constructed in two steps:</p>
<ol style="list-style-type: decimal">
<li><p>A trinomial tree is constructed for the process
<span class="math display">\[d r^*_t = -a r^*_t dt + \sigma dz_t\]</span></p></li>
<li><p>At each time step, the process is shifted to reprice the zero-coupon
of that maturity: <span class="math display">\[r_t = r^*_t + \alpha_t\]</span></p></li>
</ol>
<p>Each step is now described.</p>
<div id="step-1" class="section level3" number="23.2.1">
<h3><span class="header-section-number">23.2.1</span> Step 1</h3>
<p>The trinomial tree has time increments <span class="math inline">\(\Delta t\)</span>. Nodes are evenly
spaced with an increment <span class="math inline">\(\Delta r = \sigma \sqrt{3 \Delta t}\)</span>. Node
<span class="math inline">\((i,j)\)</span> corresponds to time step <span class="math inline">\(i \Delta t\)</span> and rate level
<span class="math inline">\(j \Delta r\)</span>.</p>
<p>From <span class="math display">\[eq:mean-ou\]</span> and <span class="math display">\[eq:var-ou\]</span>,</p>
<p><span class="math display">\[\begin{aligned}
  E(\Delta r^*) &amp;=&amp; r^*_t (e^{-a \Delta t}-1) \nonumber \\
  &amp;=&amp; -a r^* \Delta t \nonumber \\
  V(\Delta r^*) &amp;=&amp; \frac{\sigma^2}{2a} (1-e^{-2a \Delta t}) \nonumber \\
  &amp;=&amp; \sigma^2 \Delta t
\end{aligned}\]</span></p>
<p>Starting at node <span class="math inline">\((i,j)\)</span>, with rate <span class="math inline">\(r^*_t = j \Delta r\)</span>, the rate can
move to three values at step
<span class="math inline">\((i+1): r^*_t + \Delta r, r^*_t, r^*_t - \Delta r\)</span>. We now compute the
transition probabilities by matching the first two moments.</p>
<p><span class="math display">\[\begin{aligned}
  E(\Delta r^*) &amp;=&amp; p_u \Delta r - p_d \Delta r \\
&amp;=&amp; -ar^* \Delta t \\
&amp;=&amp; -a j \Delta r \Delta t \\
V(\Delta r^*) &amp;=&amp; p_u \Delta r^2 + p_d \Delta r^2 - E(\Delta r)^2 \\
&amp;=&amp; \sigma^2 \Delta t
\end{aligned}\]</span></p>
<p>After some algebra, one obtains the following system of linear
equations:</p>
<p><span class="math display">\[\begin{aligned}
    p_u + p_d &amp;=&amp; \frac{1}{3} + a^2 j^2 \Delta t^2 \\
    p_u + p_d &amp;=&amp; \frac{1}{3} + a^2 j^2 \Delta t^2-aj \Delta t
  \end{aligned}\]</span></p>
<p>Finally,</p>
<p><span class="math display">\[\begin{aligned}
    p_u &amp;=&amp; \frac{1}{6} + \frac{a^2 j^2 \Delta t^2 - aj \Delta t}{2} \\
    p_u &amp;=&amp; \frac{1}{6} + \frac{a^2 j^2 \Delta t^2 + aj \Delta t}{2} \\
    p_m &amp;=&amp; 1-p_u - p_d
  \end{aligned}\]</span></p>
<p>This calculation is illustrated below:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="the-model-of-hull-white.html#cb345-1" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> .<span class="dv">1</span>; dt <span class="ot">&lt;-</span> <span class="dv">1</span>; s <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb345-2"><a href="the-model-of-hull-white.html#cb345-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-3"><a href="the-model-of-hull-white.html#cb345-3" aria-hidden="true" tabindex="-1"></a>  pu <span class="ot">&lt;-</span> <span class="cf">function</span>(j) {</span>
<span id="cb345-4"><a href="the-model-of-hull-white.html#cb345-4" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>) <span class="sc">+</span> (a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> j<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> dt<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> a<span class="sc">*</span>j<span class="sc">*</span>dt)<span class="sc">/</span><span class="dv">2</span>}</span>
<span id="cb345-5"><a href="the-model-of-hull-white.html#cb345-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-6"><a href="the-model-of-hull-white.html#cb345-6" aria-hidden="true" tabindex="-1"></a>  pd <span class="ot">&lt;-</span> <span class="cf">function</span>(j) {</span>
<span id="cb345-7"><a href="the-model-of-hull-white.html#cb345-7" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>) <span class="sc">+</span> (a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> j<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> dt<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a<span class="sc">*</span>j<span class="sc">*</span>dt)<span class="sc">/</span><span class="dv">2</span>}</span>
<span id="cb345-8"><a href="the-model-of-hull-white.html#cb345-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-9"><a href="the-model-of-hull-white.html#cb345-9" aria-hidden="true" tabindex="-1"></a>  pm <span class="ot">&lt;-</span> <span class="cf">function</span>(j) {</span>
<span id="cb345-10"><a href="the-model-of-hull-white.html#cb345-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span><span class="fu">pu</span>(j) <span class="sc">-</span> <span class="fu">pd</span>(j)}</span>
<span id="cb345-11"><a href="the-model-of-hull-white.html#cb345-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-12"><a href="the-model-of-hull-white.html#cb345-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-13"><a href="the-model-of-hull-white.html#cb345-13" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb345-14"><a href="the-model-of-hull-white.html#cb345-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;pu: &#39;</span>, <span class="fu">pu</span>(j), <span class="st">&#39; pm: &#39;</span>, <span class="fu">pm</span>(j), <span class="st">&#39; pd: &#39;</span>, <span class="fu">pd</span>(j)))</span></code></pre></div>
<pre><code>## [1] &quot;pu:  0.166666666666667  pm:  0.666666666666667  pd:  0.166666666666667&quot;</code></pre>
<p>Sadly, the same calculation at node <span class="math inline">\((9,-9)\)</span> yields unfortunate results:</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="the-model-of-hull-white.html#cb347-1" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">9</span></span>
<span id="cb347-2"><a href="the-model-of-hull-white.html#cb347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;pu: &#39;</span>, <span class="fu">pu</span>(j), <span class="st">&#39; pm: &#39;</span>, <span class="fu">pm</span>(j), <span class="st">&#39; pd: &#39;</span>, <span class="fu">pd</span>(j)))</span></code></pre></div>
<pre><code>## [1] &quot;pu:  1.02166666666667  pm:  -0.143333333333333  pd:  0.121666666666667&quot;</code></pre>
<p>At this node, we need to change the branching pattern to ensure positive
probabilities. We compute now the transition probabilities when the
future states of <span class="math inline">\(r^*\)</span> are <span class="math inline">\(r^*+2\Delta r, r^*+ \Delta r, r^*\)</span>. The
moment-matching equations become:</p>
<p><span class="math display">\[\begin{aligned}
  E(\Delta r^*) &amp;=&amp; p_u 2\Delta r + p_m \Delta r \\
&amp;=&amp; -a j \Delta r \Delta t \\
V(\Delta r^*) &amp;=&amp; p_u (2 \Delta )r^2 + p_m \Delta r^2 - E(\Delta r)^2 \\
&amp;=&amp; \sigma^2 \Delta t
\end{aligned}\]</span></p>
<p>After some algebra, one gets:</p>
<p><span class="math display">\[\begin{aligned}
    p_u &amp;=&amp; \frac{1}{6} + \frac{a^2 j^2 \Delta t^2 + aj \Delta t}{2} \\
    p_m &amp;=&amp; 1 - p_u - p_d \\
    p_d &amp;=&amp; \frac{7}{6} + \frac{a^2 j^2 \Delta t^2 - 3aj \Delta t}{2}
  \end{aligned}\]</span></p>
<p>And we verify that the probabilities are now good:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="the-model-of-hull-white.html#cb349-1" aria-hidden="true" tabindex="-1"></a>  pu2 <span class="ot">&lt;-</span> <span class="cf">function</span>(j) {</span>
<span id="cb349-2"><a href="the-model-of-hull-white.html#cb349-2" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>) <span class="sc">+</span> (a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> j<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> dt<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a<span class="sc">*</span>j<span class="sc">*</span>dt)<span class="sc">/</span><span class="dv">2</span>}</span>
<span id="cb349-3"><a href="the-model-of-hull-white.html#cb349-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-4"><a href="the-model-of-hull-white.html#cb349-4" aria-hidden="true" tabindex="-1"></a>  pd2 <span class="ot">&lt;-</span> <span class="cf">function</span>(j) {</span>
<span id="cb349-5"><a href="the-model-of-hull-white.html#cb349-5" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">7</span><span class="sc">/</span><span class="dv">6</span>) <span class="sc">+</span> (a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> j<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> dt<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>a<span class="sc">*</span>j<span class="sc">*</span>dt)<span class="sc">/</span><span class="dv">2</span>}</span>
<span id="cb349-6"><a href="the-model-of-hull-white.html#cb349-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-7"><a href="the-model-of-hull-white.html#cb349-7" aria-hidden="true" tabindex="-1"></a>  pm2 <span class="ot">&lt;-</span> <span class="cf">function</span>(j) {</span>
<span id="cb349-8"><a href="the-model-of-hull-white.html#cb349-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span><span class="fu">pu2</span>(j) <span class="sc">-</span> <span class="fu">pd2</span>(j)}</span>
<span id="cb349-9"><a href="the-model-of-hull-white.html#cb349-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-10"><a href="the-model-of-hull-white.html#cb349-10" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">9</span></span>
<span id="cb349-11"><a href="the-model-of-hull-white.html#cb349-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;pu: &#39;</span>, <span class="fu">pu2</span>(j), <span class="st">&#39; pm: &#39;</span>, <span class="fu">pm2</span>(j), <span class="st">&#39; pd: &#39;</span>, <span class="fu">pd2</span>(j)))</span></code></pre></div>
<pre><code>## [1] &quot;pu:  0.121666666666667  pm:  0.656666666666667  pd:  0.221666666666667&quot;</code></pre>
<p>As a rule, the geometry at each node can be adapted to ensure positive
probabilities.</p>
</div>
<div id="step-2" class="section level3" number="23.2.2">
<h3><span class="header-section-number">23.2.2</span> Step 2</h3>
<p>In the next step, we transform the <span class="math inline">\(r^*\)</span> process into the actual process
for the short rate by adding a constant <span class="math inline">\(\alpha_i\)</span> to all nodes at time
step <span class="math inline">\(i\Delta t\)</span>. The calculation of constants <span class="math inline">\(\alpha_i\)</span> is performed
recursively, one time step at a time. We assume that zero-coupon rates
are known for each maturity <span class="math inline">\(i \Delta t\)</span>. The corresponding zero-coupon
prices are:</p>
<p><span class="math display">\[P(0, i \Delta t) = e^{-R(0, i \Delta t) i \Delta t}\]</span></p>
<p>The short rate at the root of the tree, <span class="math inline">\(r_{0,0}\)</span> is by definition
<span class="math inline">\(R(0, \Delta t)\)</span>, therefore:</p>
<p><span class="math display">\[\alpha_0 = R(0, \Delta t)\]</span></p>
<p>Let <span class="math inline">\(Q_{i,j}\)</span> be the price at time 0 of the Arrow-Debreu security for
state <span class="math inline">\((i,j)\)</span>. We now write the price of a zero-coupon maturing at
<span class="math inline">\(2 \Delta t\)</span>.</p>
<p><span class="math display">\[P(0,2 \Delta t) = Q_{1,1} e^{-(\alpha_1 +\Delta r) \Delta t} +
Q_{1,0} e^{-\alpha_1 \Delta t} +
Q_{1,-1} e^{-(\alpha_1 -\Delta r) \Delta t}\]</span></p>
<p>which yields:</p>
<p><span class="math display">\[\alpha_1 = \frac{1}{\Delta t} \ln \left[ \frac{Q_{1,1} e^{-\Delta r \Delta t} +
Q_{1,0} +
Q_{1,-1} e^{\Delta r \Delta t}}{P(0, 2 \Delta t)} \right]\]</span></p>
<p>The generic iteration at step <span class="math inline">\(i\)</span> is:</p>
<ol style="list-style-type: decimal">
<li><p>Solve for <span class="math inline">\(\alpha_i\)</span>:
<span class="math display">\[P(0, (m+1) \Delta t) = \sum_{j=-m}^m Q_{m,j} e^{-(\alpha_m + j \Delta r) \Delta t}\]</span></p></li>
<li><p>Compute the state prices for time step <span class="math inline">\(m\)</span>:
<span class="math display">\[Q_{m+1, j} = \sum_k Q_{m,k} p_{k,j} e^{-(\alpha_m + k \Delta r) \Delta t}\]</span></p></li>
</ol>
</div>
</div>
<div id="generalization" class="section level2" number="23.3">
<h2><span class="header-section-number">23.3</span> Generalization</h2>
<p>The Hull &amp; White model can be generalized to richer short rate
processes. For any short rate process of the form</p>
<p><span class="math display">\[df(r_t) = (\theta(t) - a f(r_t)) dt + \sigma dz_t\]</span></p>
<p>where <span class="math inline">\(f()\)</span> is invertible, define <span class="math inline">\(x = f(r)\)</span> to get:</p>
<p><span class="math display">\[dx_t = (\theta(t) - a x_t) dt + \sigma dz_t\]</span></p>
<p>Stage 1 above can be applied to the process <span class="math inline">\(dx_t\)</span>. Stage 2 is slightly
modified: let <span class="math inline">\(g(x) = f^{-1}(x)\)</span>. The equation to be solved for
<span class="math inline">\(\alpha_i\)</span> is now:</p>
<p><span class="math display">\[P(0, (m+1) \Delta t) = \sum_{j=-m}^m Q_{m,j} e^{-g(\alpha_m + j \Delta x) \Delta t}\]</span></p>
<p>Setting <span class="math inline">\(f(x) = \ln(x)\)</span> is particularly interesting, because in does not
allow negative interest rates.</p>

</div>
</div>
<p style="text-align: center;">
<a href="the-vasicek-model.html"><button class="btn btn-default">Previous</button></a>
<a href="deterministic-time-varying-volatility.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
